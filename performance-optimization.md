# 性能优化说明

## 已实施的优化措施

### 前端优化 (React/TypeScript)

1. **状态管理优化**
   - 将轮询间隔从5秒增加到30秒，主要依赖事件驱动
   - 添加状态比较，只有真正改变时才更新状态，减少不必要的重渲染
   - 使用 `useCallback` 和 `useMemo` 优化函数和计算结果的缓存
   - 添加页面可见性检测，只在页面可见时进行状态同步

2. **组件渲染优化**
   - 使用 `React.memo` 包装所有组件，避免不必要的重渲染
   - 使用 `useMemo` 缓存复杂计算结果（如XP进度、头像URL等）
   - 优化条件渲染逻辑

3. **事件处理优化**
   - 窗口位置保存使用防抖（500ms），减少频繁的文件I/O操作
   - 添加组件卸载时的清理逻辑，防止内存泄漏

### 后端优化 (Rust)

1. **自适应轮询频率**
   - 基础间隔从2秒调整到3秒
   - LCU连接失败时使用指数退避策略，最大间隔15秒
   - 在ReadyCheck状态时提高频率到500ms，确保及时响应
   - 游戏中降低频率到10秒，减少不必要的API调用

2. **状态更新优化**
   - 只有在状态真正改变时才发送事件到前端
   - 减少不必要的锁竞争和内存分配
   - 优化召唤师信息更新逻辑，只在必要时获取

3. **依赖优化**
   - 移除未使用的 `sysinfo` 依赖
   - 升级 `reqwest` 到0.12版本并禁用默认特性
   - 保持现有的release编译优化配置

## 预期效果

- **CPU占用**: 从1-2%降低到0.5-1%
- **内存占用**: 从40-50MB降低到30-40MB
- **响应性**: 保持原有的功能响应速度
- **稳定性**: 减少内存泄漏和不必要的资源消耗

## 注意事项

1. 这些优化主要针对资源消耗，不会影响核心功能
2. 自动接受匹配的响应速度得到保证（ReadyCheck时高频检查）
3. 所有事件监听和清理逻辑都已优化，防止内存泄漏